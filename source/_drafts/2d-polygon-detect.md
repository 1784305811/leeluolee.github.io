title: 2D polygon-based collision detection and response(翻译：未完成)
date: 2013-08-08 13:39:23
tags:
categories: 
---

__声明__

1. 翻译自[http://elancev.name/oliver/2D%20polygon.htm](http://elancev.name/oliver/2D%20polygon.htm)
2. 试水翻译处女文，质量可能捉急，见谅


<!-- more -->

------------------------


##引文

这是一篇关于如何在2d动作类游戏(如Maria、space invaders等)中实现物理碰撞检测并同时做到高效、精确的教程。此文的碰撞检测
基于多边形，而不是基于sprite(贴图精灵？)，这两种方式在设计和运算中都有明显区别。

基于贴图的碰撞检测是基于像素重叠，而多边形是使用向量数学通过精确计算出力的点、作用时间和方向，同时这个多边形是Sprite的近似包围盒，它相较于基于sprite的碰撞检测有如下几个优势:

* 可以较简便的实现相对真实的物理效果，比如：弹性、摩擦力以及天然可以处理比如斜坡上物体的受力等场景

* 在物体高速运动的系统中，基于多边形的碰撞检测更为精确，并可以避免可能的物体重叠。

* 基于向量数学，并可以方便的扩展到3d场景，而基于Sprite的检测只能使用在2D场景。



###特性

由于应用的算法的限制，这个系统只能处理凸多边形的场景，如：三角形、四边形、六边形、圆形等。对于非凸多边形，你仍可以将它们拆分成凸变形(三角形)的组合来解决。

无论物体是高速或是低俗运动，基于多边形的碰撞检测都不会失效，并会处理重叠的物体，将它们分离。 同时提供一个简单的物理系统，包含弹性建模、摩擦处理等，处理物体的斜坡静止等场景。此文也包含一个刚体物理的例子，实现自 Chrsi Hecker's 的教程。

这个系统也包含多边形相较的计算，可以处理子弹以及光束等游戏元素的模拟。

_译者注: 这个作者真的略啰嗦..._


### 限制

这个系统无法以有序的方式处理碰撞。这在处理高速物体时可能是个问题。一旦碰撞被检测到，它会直接处理，而在理想场景中，你可能希望看到第一个碰撞被检测到并优先处理它。但是对于一个2D动作游戏，这些可能并不是大问题。

### 需求

本文的Demo都基于GLUT(GL-Utility-Toolkit)框架，所以你需要下载它的SDK，同时你的显卡应该被opengl支持(译者注：译文的DEMO会基于canvas和js，所以请蛋定)。

你同时需要有一点基础的向量数学知识。本文的对于向量知识的要求实际上没有超越向量点乘计算的这个层级，但是拥有较好的向量知识，对于理解本文是很有帮助的。

而刚体物理部分，你必须完整的阅读过 Chris Hecker's 的教程，这可能需要一些工作，但是完全值得 :) 


### 目录

1. [分离坐标轴的方法](#tutor1)
2. [扩展教程1的方法实现碰撞侦测](#tutor2)
3. [继续扩展实现快速物体的碰撞检测](#tutor3)
4. [基本接机碰撞效应](#tutor4)
5. [处理旋转](#tutor5)
6. [计算接触点](#tutor6)
7. [刚体动力学](#tutor7)


<a name='tutor1'></a>
## 坐标的轴分离法

此章节是本文的基础核心部分，原理非常简单并且易于实现，由于没有涉及到除法计算，运行效率稳定并且高效。

这里以两个矩形盒的碰撞测试做为演示例子，如下图

![两盒碰撞](/images/2d-polygon/001.gif)

如图所示，本文的算法会试图去找出一条介于两物体的直线(与它们都不相交)，如果存在，则证明它们是非相交的。

如何判断这个平面是否符合要求呢？ 很简单，我们可以通过判断两物体在此平面的__法线__的投影是否相交即可。

很明显，两物体间可以有无数个待测平面(2D条件下即表现为一直线)。值得庆幸的是，已经被证明只需测试部分平面即可确定是否相交了。 以上图为例，其中图中所示的待测平面的法线就是矩形的长边。

需要测试分别以待测凸多边形的每条边作为法线的平面，对于上图的两个矩形而言，你只需测试4个平面(译者注：边都是平行的)。一旦你发现有一个平面是与两个矩形都不相交的，则两平面未碰撞，反之则发生了碰撞。

现在问题转换到了，如何证明以某条作为法线，答案是投影。

<canvas id='tutor1' width=640 height=480></canvas>



<a name='tutor2'></a>
## 扩展教程1的方法实现碰撞检测










----------------------

## 译者尾述

本文是个相对简单的教程，但是是2d物理学的绝对基础。


<script src='/js/2d-polygon/math.js'></script>



## TODO

1. 建立一个生成随机凸多边形的方法(一个圆 ，随机点)，这个无需证明了
2. 封装vec2， 算法1可以优化，同样的垂直向量就不需要计算两次了
3. 使用jsfiddle
